# py正则表达式
### 写xls文件

```python
import re
#import xlrd
import xlwt

#打开文件
file = open("/home/per/Documents/Report/wire/taobao_viewer_userB_1149pm.txt")

#读取文件
text = file.read()
#print text

#简单正则匹配筛出出cookie_pair名称得到arr数组
regex = r"\w*?(?==)"
pat = re.compile(regex)
arr = pat.findall(text)

#去除重复及空白字段,得最终cookie_pair名称brr数组
brr = list(set(arr))
#print brr
#print len(brr)
if '' in brr:
    brr.remove('')
print len(brr)
print brr

#匹配填写表格的cookie_pair字段crr数组
regex1 = r"\w*?=\w.*?(?=,)"
pat1 = re.compile(regex1)
crr = pat1.findall(text)
#print arr

#xlwt创建表单表格
xlsfile = xlwt.Workbook()
xlstable = xlsfile.add_sheet("cook_pair",cell_overwrite_ok=True)

#匹配crr数组的cookie_pair名称与brr的作对比得到col值
regex2 = r"\w.*?(?==)"
pat2 = re.compile(regex2)

#初始化全局变量row col
row = 0
col = 0

#将brr数组cookie_pair名称写入第一行即row=0的行
for i in range (0,len(brr)):
    xlstable.write(0,i,brr[i])

#匹配crr数组cookie_pair名称与row=0的行的brr数组名称得到col值
for i in range (0,len(crr)):
    match = re.match(regex2,crr[i])
    cookie_name = match.group(0)
    for j in range (0,len(brr)):
        if cookie_name == brr[j]:
            col = j

#row的计算有一点小问题因为brr的长度并不是crr每一个包cookie_pair的长度
#可能会导致上一个包的字段存到下一行
#应该将crr数组正则匹配存为二维数组
    row = i%len(brr)
    xlstable.write(row,col,crr[i])

#保存文件
xlsfile.save("cookie.xls")

```
input() py3
raw_input() py2
#coding=utf-8 #=周围不能空格
